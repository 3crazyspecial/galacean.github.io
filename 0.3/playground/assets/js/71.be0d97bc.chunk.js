(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{500:function(n,r,e){"use strict";e.r(r),r.default='import { OrbitControl } from "@oasis-engine/controls";\r\nimport * as dat from "dat.gui";\r\nimport {\r\n  AssetType,\r\n  Camera,\r\n  EnvironmentMapLight,\r\n  MeshRenderer,\r\n  PBRMaterial,\r\n  PrimitiveMesh,\r\n  SkyBox,\r\n  SystemInfo,\r\n  TextureCubeMap,\r\n  Vector3,\r\n  WebGLEngine\r\n} from "oasis-engine";\r\n\r\n/**\r\n * use PBR material\r\n */\r\nfunction usePBR(rows = 5, cols = 5, radius = 1, gap = 1) {\r\n  const deltaGap = radius * 2 + gap;\r\n  const minX = (-deltaGap * (cols - 1)) / 2;\r\n  const maxY = (deltaGap * (rows - 1)) / 2;\r\n  const deltaMetal = 1 / (cols - 1);\r\n  const deltaRoughness = 1 / (rows - 1);\r\n\r\n  // create model mesh\r\n  const mesh = PrimitiveMesh.createSphere(engine, radius, 64);\r\n\r\n  // create renderer\r\n  for (let i = 0, count = rows * cols; i < count; i++) {\r\n    const entity = rootEntity.createChild();\r\n    const renderer = entity.addComponent(MeshRenderer);\r\n    const material = new PBRMaterial(engine);\r\n    const currentRow = Math.floor(i / cols);\r\n    const currentCol = i % cols;\r\n\r\n    renderer.mesh = mesh;\r\n    renderer.setMaterial(material);\r\n    entity.transform.setPosition(minX + currentCol * deltaGap, maxY - currentRow * deltaGap, 0);\r\n\r\n    // pbr metallic\r\n    material.metallicFactor = 1 - deltaMetal * currentRow;\r\n\r\n    // pbr roughness\r\n    material.roughnessFactor = deltaRoughness * currentCol;\r\n\r\n    // base color\r\n    if (currentRow === 0) {\r\n      material.baseColor.setValue(186 / 255, 110 / 255, 64 / 255, 1.0);\r\n    } else if (currentRow === rows - 1) {\r\n      material.baseColor.setValue(0, 0, 0, 1);\r\n    }\r\n  }\r\n}\r\n\r\nconst gui = new dat.GUI();\r\nconst guiDebug = {\r\n  env: "forrest",\r\n  introX: "\u4ece\u5de6\u5230\u53f3\u7c97\u7cd9\u5ea6\u9012\u589e",\r\n  introY: "\u4ece\u4e0a\u5230\u4e0b\u91d1\u5c5e\u5ea6\u9012\u51cf"\r\n};\r\ngui.add(guiDebug, "introX");\r\ngui.add(guiDebug, "introY");\r\n\r\n// create engine object\r\nconst engine = new WebGLEngine("o3-demo");\r\nengine.canvas.width = window.innerWidth * SystemInfo.devicePixelRatio;\r\nengine.canvas.height = window.innerHeight * SystemInfo.devicePixelRatio;\r\n\r\nconst scene = engine.sceneManager.activeScene;\r\nconst rootEntity = scene.createRootEntity();\r\n\r\n// create camera\r\nconst cameraEntity = rootEntity.createChild("camera_entity");\r\ncameraEntity.transform.position = new Vector3(0, 0, 20);\r\ncameraEntity.addComponent(Camera);\r\nconst control = cameraEntity.addComponent(OrbitControl);\r\ncontrol.maxDistance = 20;\r\ncontrol.minDistance = 2;\r\n\r\n// create skybox\r\nconst skybox = rootEntity.addComponent(SkyBox);\r\n\r\n// create env light\r\nconst envLight = rootEntity.addComponent(EnvironmentMapLight);\r\n\r\n// load env texture\r\nengine.resourceManager\r\n  .load([\r\n    {\r\n      urls: [\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*Bk5FQKGOir4AAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*_cPhR7JMDjkAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*trqjQp1nOMQAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*_RXwRqwMK3EAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*q4Q6TroyuXcAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*DP5QTbTSAYgAAAAAAAAAAAAAARQnAQ"\r\n      ],\r\n      type: AssetType.TextureCube\r\n    },\r\n    {\r\n      urls: [\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*5w6_Rr6ML6IAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*TiT2TbN5cG4AAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*8GF6Q4LZefUAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*D5pdRqUHC3IAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*_FooTIp6pNIAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*CYGZR7ogZfoAAAAAAAAAAAAAARQnAQ"\r\n      ],\r\n      type: AssetType.TextureCube\r\n    },\r\n    {\r\n      urls: [\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*4ebgQaWOLaIAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*i56eR6AbreUAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*3wYERKsel5oAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*YiG7Srwmb3QAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*VUUwQrAv47sAAAAAAAAAAAAAARQnAQ",\r\n        "https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*Dn2qSoqzfwoAAAAAAAAAAAAAARQnAQ"\r\n      ],\r\n      type: AssetType.TextureCube\r\n    }\r\n  ])\r\n  .then((cubeMaps: TextureCubeMap[]) => {\r\n    envLight.diffuseTexture = cubeMaps[0];\r\n    envLight.specularTexture = cubeMaps[1];\r\n    skybox.skyBoxMap = cubeMaps[1];\r\n    gui.add(guiDebug, "env", ["forrest", "road"]).onChange((v) => {\r\n      switch (v) {\r\n        case "forrest":\r\n          envLight.specularTexture = cubeMaps[1];\r\n          skybox.skyBoxMap = cubeMaps[1];\r\n          break;\r\n        case "road":\r\n          envLight.specularTexture = cubeMaps[2];\r\n          skybox.skyBoxMap = cubeMaps[2];\r\n          break;\r\n      }\r\n    });\r\n  });\r\n\r\n// run engine\r\nengine.run();\r\n\r\n// show pbr materials\r\nusePBR();\r\n'}}]);